{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport HttpService from '../../Servicios/HttpService';\nimport DialogoCategorias from './DialogoCategorias';\nexport default {\n  name: \"CategoriasComponent\",\n  components: {\n    DialogoCategorias: DialogoCategorias\n  },\n  data: function data() {\n    return {\n      categorias: [],\n      cargando: false,\n      mostrarDialogoCategorias: false,\n      tituloModal: \"\",\n      nombreCategoria: \"\",\n      idCategoria: \"\"\n    };\n  },\n  mounted: function mounted() {\n    this.obtenerCategorias();\n  },\n  methods: {\n    eliminar: function eliminar(categoria) {\n      var _this = this;\n\n      this.$buefy.dialog.confirm({\n        title: 'Eliminar categoría',\n        message: 'Seguro que quieres <b>eliminar</b> la categoría ' + categoria.nombreCategoria + '? Esta acción no se puede revertir.',\n        confirmText: 'Sí, eliminar',\n        cancelText: 'Cancelar',\n        type: 'is-danger',\n        hasIcon: true,\n        onConfirm: function onConfirm() {\n          _this.cargando = true;\n          HttpService.eliminar('categorias.php', {\n            accion: 'eliminar',\n            id: categoria.id\n          }).then(function (resultado) {\n            if (!resultado) {\n              _this.$buefy.toast.open('Error al eliminar');\n\n              _this.cargando = false;\n              return;\n            }\n\n            if (resultado) {\n              _this.cargando = false;\n\n              _this.$buefy.toast.open({\n                type: 'is-info',\n                message: 'Categoría eliminada.'\n              });\n\n              _this.obtenerCategorias();\n            }\n          });\n        }\n      });\n    },\n    editar: function editar(categoria) {\n      this.tituloModal = \"Editar\";\n      this.mostrarDialogoCategorias = true;\n      this.idCategoria = categoria.id;\n      this.nombreCategoria = categoria.nombreCategoria;\n    },\n    onCerrarDialogo: function onCerrarDialogo() {\n      this.mostrarDialogoCategorias = false;\n      this.nombreCategoria = \"\";\n    },\n    onRegistrar: function onRegistrar(nombre) {\n      var _this2 = this;\n\n      this.cargando = true;\n      var accionARealizar = this.tituloModal === 'Agregar' ? 'registrar' : this.tituloModal === 'Editar' ? 'editar' : false;\n      HttpService.registrar('categorias.php', {\n        accion: accionARealizar,\n        categoria: {\n          nombreCategoria: nombre,\n          id: this.idCategoria\n        }\n      }).then(function (registrado) {\n        if (registrado === 'existe') {\n          _this2.$buefy.toast.open({\n            type: 'is-primary',\n            message: 'La categoría' + nombre + ' ya existe, selecciona otra.'\n          });\n\n          _this2.cargando = false;\n          return;\n        }\n\n        if (registrado) {\n          _this2.cargando = false;\n\n          _this2.$buefy.toast.open({\n            type: 'is-info',\n            message: 'Información de categoría registrada con éxito.'\n          });\n\n          _this2.obtenerCategorias();\n\n          _this2.nombreCategoria = \"\";\n          _this2.mostrarDialogoCategorias = false;\n        }\n      });\n    },\n    agregarCategoria: function agregarCategoria() {\n      this.tituloModal = \"Agregar\";\n      this.mostrarDialogoCategorias = true;\n    },\n    obtenerCategorias: function obtenerCategorias() {\n      var _this3 = this;\n\n      this.cargando = true;\n      var payload = {\n        accion: 'obtener'\n      };\n      HttpService.obtenerConConsultas('categorias.php', payload).then(function (categorias) {\n        _this3.categorias = categorias;\n        _this3.cargando = false;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AAEA;EACAA,2BADA;EAEAC;IAAAC;EAAA,CAFA;EAGAC;IAAA;MACAC,cADA;MAEAC,eAFA;MAGAC,+BAHA;MAIAC,eAJA;MAKAC,mBALA;MAMAC;IANA;EAAA,CAHA;EAYAC,OAZA,qBAYA;IACA;EACA,CAdA;EAgBAC;IACAC,QADA,oBACAC,SADA,EACA;MAAA;;MACA;QACAC,2BADA;QAEAC,+HAFA;QAGAC,2BAHA;QAIAC,sBAJA;QAKAC,iBALA;QAMAC,aANA;QAOAC;UACA;UACAC;YACAC,kBADA;YAEAC;UAFA,GAIAC,IAJA,CAIA;YACA;cACA;;cACA;cACA;YACA;;YAEA;cACA;;cACA;gBACAN,eADA;gBAEAH;cAFA;;cAIA;YACA;UACA,CAnBA;QAoBA;MA7BA;IA+BA,CAjCA;IAmCAU,MAnCA,kBAmCAZ,SAnCA,EAmCA;MACA;MACA;MACA;MACA;IACA,CAxCA;IA0CAa,eA1CA,6BA0CA;MACA;MACA;IACA,CA7CA;IA+CAC,WA/CA,uBA+CAC,MA/CA,EA+CA;MAAA;;MACA;MAEA;MAEAP;QACAC,uBADA;QAEAT;UAAAL;UAAAe;QAAA;MAFA,GAIAC,IAJA,CAIA;QACA;UACA;YACAN,kBADA;YAEAH;UAFA;;UAIA;UACA;QACA;;QAEA;UACA;;UACA;YACAG,eADA;YAEAH;UAFA;;UAIA;;UACA;UACA;QACA;MACA,CAxBA;IAyBA,CA7EA;IA+EAc,gBA/EA,8BA+EA;MACA;MACA;IACA,CAlFA;IAoFAC,iBApFA,+BAoFA;MAAA;;MACA;MACA;QACAR;MADA;MAGAD,2DACAG,IADA,CACA;QACA;QACA;MACA,CAJA;IAKA;EA9FA;AAhBA","names":["name","components","DialogoCategorias","data","categorias","cargando","mostrarDialogoCategorias","tituloModal","nombreCategoria","idCategoria","mounted","methods","eliminar","categoria","title","message","confirmText","cancelText","type","hasIcon","onConfirm","HttpService","accion","id","then","editar","onCerrarDialogo","onRegistrar","nombre","agregarCategoria","obtenerCategorias"],"sourceRoot":"src/components/MarcasCategorias","sources":["CategoriasComponent.vue"],"sourcesContent":["<template>\r\n\t<section>\r\n\t\t<b-button type=\"is-primary\" size=\"is-medium\" class=\"is-rounded\" icon-left=\"plus\" @click=\"agregarCategoria\">\r\n\t\t\tAgregar categoría\r\n\t\t</b-button>\r\n\t\t<b-table\r\n\t\t:data=\"categorias\">\r\n\t\t<b-table-column field=\"nombreCategoria\" label=\"Categoria\" sortable searchable v-slot=\"props\">\r\n\t\t\t{{ props.row.nombreCategoria }}\r\n\t\t</b-table-column>\r\n\r\n\t\t<b-table-column field=\"eliminar\" label=\"Eliminar\" v-slot=\"props\">\r\n\t\t\t<b-button type=\"is-danger\" icon-left=\"delete\" @click=\"eliminar(props.row)\">Eliminar</b-button>\r\n\t\t</b-table-column>\r\n\r\n\t\t<b-table-column field=\"editar\" label=\"Editar\" v-slot=\"props\">\r\n\t\t\t<b-button type=\"is-info\" icon-left=\"pen\" @click=\"editar(props.row)\">Editar</b-button>\r\n\t\t</b-table-column>\r\n\t</b-table>\r\n\t<b-modal\r\n\tv-model=\"mostrarDialogoCategorias\"\r\n\thas-modal-card\r\n\ttrap-focus\r\n\t:destroy-on-hide=\"false\"\r\n\taria-role=\"dialog\"\r\n\taria-label=\"Modal\"\r\n\tclose-button-aria-label=\"Close\"\r\n\taria-modal>\r\n\t<dialogo-categorias :titulo=\"tituloModal\" :nombre=\"nombreCategoria\" @close=\"onCerrarDialogo\" @registrar=\"onRegistrar\" v-if=\"mostrarDialogoCategorias\"></dialogo-categorias>\r\n</b-modal>\r\n\r\n<b-loading :is-full-page=\"true\" v-model=\"cargando\" :can-cancel=\"false\"></b-loading>\r\n</section>\r\n</template>\r\n<script>\r\n\timport HttpService from '../../Servicios/HttpService'\r\n\timport DialogoCategorias from './DialogoCategorias'\r\n\r\n\texport default{\r\n\t\tname: \"CategoriasComponent\",\r\n\t\tcomponents: { DialogoCategorias },\r\n\t\tdata:()=>({     \r\n\t\t\tcategorias: [],\r\n\t\t\tcargando: false,\r\n\t\t\tmostrarDialogoCategorias: false,\r\n\t\t\ttituloModal: \"\",\r\n\t\t\tnombreCategoria: \"\",\r\n\t\t\tidCategoria: \"\",\r\n\t\t}),\r\n\r\n\t\tmounted(){\r\n\t\t\tthis.obtenerCategorias()\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\t\t\teliminar(categoria){\r\n\t\t\t\tthis.$buefy.dialog.confirm({\r\n\t\t\t\t\ttitle: 'Eliminar categoría',\r\n\t\t\t\t\tmessage: 'Seguro que quieres <b>eliminar</b> la categoría ' + categoria.nombreCategoria +'? Esta acción no se puede revertir.',\r\n\t\t\t\t\tconfirmText: 'Sí, eliminar',\r\n\t\t\t\t\tcancelText: 'Cancelar',\r\n\t\t\t\t\ttype: 'is-danger',\r\n\t\t\t\t\thasIcon: true,\r\n\t\t\t\t\tonConfirm: () => {\r\n\t\t\t\t\t\tthis.cargando = true\r\n\t\t\t\t\t\tHttpService.eliminar('categorias.php',{\r\n\t\t\t\t\t\t\taccion: 'eliminar',\r\n\t\t\t\t\t\t\tid: categoria.id\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(resultado => {\r\n\t\t\t\t\t\t\tif(!resultado) {\r\n\t\t\t\t\t\t\t\tthis.$buefy.toast.open('Error al eliminar')\r\n\t\t\t\t\t\t\t\tthis.cargando = false\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(resultado){\r\n\t\t\t\t\t\t\t\tthis.cargando = false\r\n\t\t\t\t\t\t\t\tthis.$buefy.toast.open({\r\n\t\t\t\t\t\t\t\t\ttype: 'is-info',\r\n\t\t\t\t\t\t\t\t\tmessage: 'Categoría eliminada.'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tthis.obtenerCategorias()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\teditar(categoria){\r\n\t\t\t\tthis.tituloModal = \"Editar\"\r\n\t\t\t\tthis.mostrarDialogoCategorias = true\r\n\t\t\t\tthis.idCategoria = categoria.id\r\n\t\t\t\tthis.nombreCategoria = categoria.nombreCategoria\r\n\t\t\t}, \r\n\r\n\t\t\tonCerrarDialogo(){\r\n\t\t\t\tthis.mostrarDialogoCategorias = false\r\n\t\t\t\tthis.nombreCategoria = \"\" \r\n\t\t\t},\r\n\r\n\t\t\tonRegistrar(nombre) {\r\n\t\t\t\tthis.cargando = true\r\n\r\n\t\t\t\tlet accionARealizar = (this.tituloModal === 'Agregar') ? 'registrar' : (this.tituloModal === 'Editar') ? 'editar' : false\r\n\r\n\t\t\t\tHttpService.registrar('categorias.php', {\r\n\t\t\t\t\taccion: accionARealizar,\r\n\t\t\t\t\tcategoria: {nombreCategoria:nombre, id: this.idCategoria }\r\n\t\t\t\t})\r\n\t\t\t\t.then(registrado => {\r\n\t\t\t\t\tif(registrado === 'existe'){\r\n\t\t\t\t\t\tthis.$buefy.toast.open({\r\n\t\t\t\t\t\t\ttype: 'is-primary',\r\n\t\t\t\t\t\t\tmessage: 'La categoría' + nombre +' ya existe, selecciona otra.'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.cargando = false\r\n\t\t\t\t\t\treturn \r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(registrado) {\r\n\t\t\t\t\t\tthis.cargando = false\r\n\t\t\t\t\t\tthis.$buefy.toast.open({\r\n\t\t\t\t\t\t\ttype: 'is-info',\r\n\t\t\t\t\t\t\tmessage: 'Información de categoría registrada con éxito.'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.obtenerCategorias()\r\n\t\t\t\t\t\tthis.nombreCategoria = \"\"\r\n\t\t\t\t\t\tthis.mostrarDialogoCategorias = false\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tagregarCategoria(){\r\n\t\t\t\tthis.tituloModal = \"Agregar\"\r\n\t\t\t\tthis.mostrarDialogoCategorias = true\r\n\t\t\t},\r\n\r\n\t\t\tobtenerCategorias(){\r\n\t\t\t\tthis.cargando = true\r\n\t\t\t\tlet payload = {\r\n\t\t\t\t\taccion: 'obtener'\r\n\t\t\t\t}\r\n\t\t\t\tHttpService.obtenerConConsultas('categorias.php', payload)\r\n\t\t\t\t.then(categorias => {\r\n\t\t\t\t\tthis.categorias = categorias\r\n\t\t\t\t\tthis.cargando = false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>"]},"metadata":{},"sourceType":"module"}