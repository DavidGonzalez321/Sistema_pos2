{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport DialogoMarcas from './DialogoMarcas';\nimport HttpService from '../../Servicios/HttpService';\nexport default {\n  name: \"MarcasComponent\",\n  components: {\n    DialogoMarcas: DialogoMarcas\n  },\n  data: function data() {\n    return {\n      cargando: false,\n      marcas: [],\n      mostrarDialogoMarcas: false,\n      tituloModal: \"\",\n      nombreMarca: \"\",\n      idMarca: \"\"\n    };\n  },\n  mounted: function mounted() {\n    this.obtenerMarcas();\n  },\n  methods: {\n    eliminar: function eliminar(marca) {\n      var _this = this;\n\n      this.$buefy.dialog.confirm({\n        title: 'Eliminar marca',\n        message: 'Seguro que quieres <b>eliminar</b> la marca ' + marca.nombreMarca + '? Esta acción no se puede revertir.',\n        confirmText: 'Sí, eliminar',\n        cancelText: 'Cancelar',\n        type: 'is-danger',\n        hasIcon: true,\n        onConfirm: function onConfirm() {\n          _this.cargando = true;\n          HttpService.eliminar('marcas.php', {\n            accion: 'eliminar',\n            id: marca.id\n          }).then(function (resultado) {\n            if (!resultado) {\n              _this.$buefy.toast.open('Error al eliminar');\n\n              _this.cargando = false;\n              return;\n            }\n\n            if (resultado) {\n              _this.cargando = false;\n\n              _this.$buefy.toast.open({\n                type: 'is-info',\n                message: 'Marca eliminada.'\n              });\n\n              _this.obtenerMarcas();\n            }\n          });\n        }\n      });\n    },\n    editar: function editar(marca) {\n      this.tituloModal = \"Editar\";\n      this.mostrarDialogoMarcas = true, this.idMarca = marca.id;\n      this.nombreMarca = marca.nombreMarca;\n    },\n    onCerrarDialogo: function onCerrarDialogo() {\n      this.mostrarDialogoMarcas = false;\n      this.nombreMarca = \"\";\n    },\n    onRegistrar: function onRegistrar(nombre) {\n      var _this2 = this;\n\n      this.cargando = true;\n      var accionARealizar = this.tituloModal === 'Agregar' ? 'registrar' : this.tituloModal === 'Editar' ? 'editar' : false;\n      HttpService.registrar('marcas.php', {\n        accion: accionARealizar,\n        marca: {\n          nombreMarca: nombre,\n          id: this.idMarca\n        }\n      }).then(function (registrado) {\n        if (registrado === 'existe') {\n          _this2.$buefy.toast.open({\n            type: 'is-primary',\n            message: 'La marca' + nombre + ' ya existe, selecciona otra.'\n          });\n\n          _this2.cargando = false;\n          return;\n        }\n\n        if (registrado) {\n          _this2.cargando = false;\n\n          _this2.$buefy.toast.open({\n            type: 'is-info',\n            message: 'Información de marca registrada con éxito.'\n          });\n\n          _this2.obtenerMarcas();\n\n          _this2.nombreMarca = \"\";\n          _this2.mostrarDialogoMarcas = false;\n        }\n      });\n    },\n    agregarMarca: function agregarMarca() {\n      this.tituloModal = \"Agregar\";\n      this.mostrarDialogoMarcas = true;\n    },\n    obtenerMarcas: function obtenerMarcas() {\n      var _this3 = this;\n\n      this.cargando = true;\n      var payload = {\n        accion: 'obtener'\n      };\n      HttpService.obtenerConConsultas('marcas.php', payload).then(function (marcas) {\n        _this3.marcas = marcas;\n        _this3.cargando = false;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AAEA;EACAA,uBADA;EAEAC;IAAAC;EAAA,CAFA;EAIAC;IAAA;MACAC,eADA;MAEAC,UAFA;MAGAC,2BAHA;MAIAC,eAJA;MAKAC,eALA;MAMAC;IANA;EAAA,CAJA;EAaAC,OAbA,qBAaA;IACA;EACA,CAfA;EAiBAC;IACAC,QADA,oBACAC,KADA,EACA;MAAA;;MACA;QACAC,uBADA;QAEAC,mHAFA;QAGAC,2BAHA;QAIAC,sBAJA;QAKAC,iBALA;QAMAC,aANA;QAOAC;UACA;UACAC;YACAC,kBADA;YAEAC;UAFA,GAIAC,IAJA,CAIA;YACA;cACA;;cACA;cACA;YACA;;YAEA;cACA;;cACA;gBACAN,eADA;gBAEAH;cAFA;;cAIA;YACA;UACA,CAnBA;QAoBA;MA7BA;IA+BA,CAjCA;IAkCAU,MAlCA,kBAkCAZ,KAlCA,EAkCA;MACA;MACA,kCACA,uBADA;MAEA;IACA,CAvCA;IAyCAa,eAzCA,6BAyCA;MACA;MACA;IACA,CA5CA;IA8CAC,WA9CA,uBA8CAC,MA9CA,EA8CA;MAAA;;MACA;MAEA;MAEAP;QACAC,uBADA;QAEAT;UAAAL;UAAAe;QAAA;MAFA,GAIAC,IAJA,CAIA;QACA;UACA;YACAN,kBADA;YAEAH;UAFA;;UAIA;UACA;QACA;;QAEA;UACA;;UACA;YACAG,eADA;YAEAH;UAFA;;UAIA;;UACA;UACA;QACA;MACA,CAxBA;IAyBA,CA5EA;IA8EAc,YA9EA,0BA8EA;MACA;MACA;IACA,CAjFA;IAmFAC,aAnFA,2BAmFA;MAAA;;MACA;MACA;QACAR;MADA;MAGAD,uDACAG,IADA,CACA;QACA;QACA;MACA,CAJA;IAKA;EA7FA;AAjBA","names":["name","components","DialogoMarcas","data","cargando","marcas","mostrarDialogoMarcas","tituloModal","nombreMarca","idMarca","mounted","methods","eliminar","marca","title","message","confirmText","cancelText","type","hasIcon","onConfirm","HttpService","accion","id","then","editar","onCerrarDialogo","onRegistrar","nombre","agregarMarca","obtenerMarcas"],"sourceRoot":"src/components/MarcasCategorias","sources":["MarcasComponent.vue"],"sourcesContent":["<template>\r\n    <section>\r\n         <b-button type=\"is-primary\" size=\"is-medium\" class=\"is-rounded\" icon-left=\"plus\" @click=\"agregarMarca\">\r\n          Agregar marca\r\n        </b-button>\r\n\r\n        <b-table\r\n        :data=\"marcas\">\r\n          <b-table-column field=\"nombreMarca\" label=\"Marca\" sortable searchable v-slot=\"props\">\r\n                {{ props.row.nombreMarca }}\r\n            </b-table-column>\r\n\r\n            <b-table-column field=\"eliminar\" label=\"Eliminar\" v-slot=\"props\">\r\n                <b-button type=\"is-danger\" icon-left=\"delete\" @click=\"eliminar(props.row)\">Eliminar</b-button>\r\n            </b-table-column>\r\n\r\n            <b-table-column field=\"editar\" label=\"Editar\" v-slot=\"props\">\r\n                <b-button type=\"is-info\" icon-left=\"pen\" @click=\"editar(props.row)\">Editar</b-button>\r\n            </b-table-column>\r\n        </b-table>\r\n\r\n         <b-modal\r\n          v-model=\"mostrarDialogoMarcas\"\r\n          has-modal-card\r\n          trap-focus\r\n          :destroy-on-hide=\"false\"\r\n          aria-role=\"dialog\"\r\n          aria-label=\"Modal\"\r\n          close-button-aria-label=\"Close\"\r\n          aria-modal>\r\n              <dialogo-marcas :titulo=\"tituloModal\" :nombre=\"nombreMarca\" @close=\"onCerrarDialogo\" @registrar=\"onRegistrar\" v-if=\"mostrarDialogoMarcas\"></dialogo-marcas>\r\n        </b-modal>\r\n\r\n        <b-loading :is-full-page=\"true\" v-model=\"cargando\" :can-cancel=\"false\"></b-loading>\r\n    </section>\r\n</template>\r\n<script>\r\n    import DialogoMarcas from './DialogoMarcas'\r\n    import HttpService from '../../Servicios/HttpService'\r\n\r\n    export default{\r\n        name: \"MarcasComponent\",\r\n        components: { DialogoMarcas },\r\n\r\n        data:()=>({\r\n            cargando: false,\r\n            marcas: [],\r\n            mostrarDialogoMarcas: false,\r\n            tituloModal: \"\",\r\n            nombreMarca: \"\",\r\n            idMarca: \"\",\r\n        }),\r\n\r\n        mounted(){\r\n            this.obtenerMarcas()\r\n        },\r\n\r\n        methods: {\r\n            eliminar(marca){\r\n                this.$buefy.dialog.confirm({\r\n                    title: 'Eliminar marca',\r\n                    message: 'Seguro que quieres <b>eliminar</b> la marca ' + marca.nombreMarca +'? Esta acción no se puede revertir.',\r\n                    confirmText: 'Sí, eliminar',\r\n                    cancelText: 'Cancelar',\r\n                    type: 'is-danger',\r\n                    hasIcon: true,\r\n                    onConfirm: () => {\r\n                        this.cargando = true\r\n                        HttpService.eliminar('marcas.php',{\r\n                            accion: 'eliminar',\r\n                            id: marca.id\r\n                        })\r\n                        .then(resultado => {\r\n                            if(!resultado) {\r\n                                this.$buefy.toast.open('Error al eliminar')\r\n                                this.cargando = false\r\n                                return\r\n                            }\r\n\r\n                            if(resultado){\r\n                                this.cargando = false\r\n                                this.$buefy.toast.open({\r\n                                    type: 'is-info',\r\n                                    message: 'Marca eliminada.'\r\n                                })\r\n                                this.obtenerMarcas()\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            },\r\n            editar(marca){\r\n                this.tituloModal = \"Editar\"\r\n                this.mostrarDialogoMarcas = true,\r\n                this.idMarca = marca.id\r\n                this.nombreMarca = marca.nombreMarca\r\n            }, \r\n\r\n            onCerrarDialogo(){\r\n                this.mostrarDialogoMarcas = false\r\n                this.nombreMarca = \"\" \r\n            },\r\n\r\n            onRegistrar(nombre) {\r\n                this.cargando = true\r\n\r\n                let accionARealizar = (this.tituloModal === 'Agregar') ? 'registrar' : (this.tituloModal === 'Editar') ? 'editar' : false\r\n\r\n                HttpService.registrar('marcas.php', {\r\n                    accion: accionARealizar,\r\n                    marca: {nombreMarca:nombre, id: this.idMarca }\r\n                })\r\n                .then(registrado => {\r\n                    if(registrado === 'existe'){\r\n                        this.$buefy.toast.open({\r\n                          type: 'is-primary',\r\n                          message: 'La marca' + nombre +' ya existe, selecciona otra.'\r\n                        })\r\n                        this.cargando = false\r\n                        return \r\n                    }\r\n\r\n                    if(registrado) {\r\n                        this.cargando = false\r\n                        this.$buefy.toast.open({\r\n                          type: 'is-info',\r\n                          message: 'Información de marca registrada con éxito.'\r\n                        })\r\n                        this.obtenerMarcas()\r\n                        this.nombreMarca = \"\"\r\n                        this.mostrarDialogoMarcas = false\r\n                    }\r\n                })\r\n            },\r\n\r\n            agregarMarca(){\r\n                this.tituloModal = \"Agregar\"\r\n                this.mostrarDialogoMarcas = true\r\n            },\r\n\r\n            obtenerMarcas(){\r\n                this.cargando = true\r\n                let payload = {\r\n                  accion: 'obtener'\r\n                }\r\n                HttpService.obtenerConConsultas('marcas.php', payload)\r\n                .then(marcas => {\r\n                  this.marcas = marcas\r\n                  this.cargando = false\r\n                })\r\n            },\r\n        } \r\n    }\r\n</script>"]},"metadata":{},"sourceType":"module"}