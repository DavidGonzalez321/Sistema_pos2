{"ast":null,"code":"import \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport BusquedaEnFecha from '../Extras/BusquedaEnFecha';\nimport MensajeInicial from '../Extras/MensajeInicial';\nimport CartasTotales from '../Extras/CartasTotales';\nimport TablaProductosVendidos from './TablaProductosVendidos';\nimport ComprobanteCompra from './ComprobanteCompra';\nimport HttpService from '../../Servicios/HttpService';\nimport Utiles from '../../Servicios/Utiles';\nexport default {\n  name: \"ReporteVentas\",\n  components: {\n    BusquedaEnFecha: BusquedaEnFecha,\n    TablaProductosVendidos: TablaProductosVendidos,\n    MensajeInicial: MensajeInicial,\n    CartasTotales: CartasTotales,\n    ComprobanteCompra: ComprobanteCompra\n  },\n  data: function data() {\n    return {\n      filtros: {\n        fechaInicio: \"\",\n        fechaFin: \"\"\n      },\n      cargando: false,\n      ventas: [],\n      isPaginated: true,\n      isPaginationSimple: false,\n      isPaginationRounded: true,\n      paginationPosition: 'bottom',\n      defaultSortDirection: 'asc',\n      sortIcon: 'arrow-up',\n      sortIconSize: 'is-medium',\n      currentPage: 1,\n      perPage: 5,\n      totalesGenerales: [],\n      mostrarComprobante: false,\n      ventaSeleccionada: null\n    };\n  },\n  mounted: function mounted() {\n    this.obtenerVentas();\n  },\n  methods: {\n    onImpreso: function onImpreso(resultado) {\n      this.mostrarComprobante = resultado;\n    },\n    generarComprobante: function generarComprobante(venta) {\n      this.mostrarComprobante = true;\n      this.ventaSeleccionada = venta;\n    },\n    onBusquedaEnFecha: function onBusquedaEnFecha(fechas) {\n      this.filtros.fechaInicio = fechas[0].toISOString().split('T')[0];\n      this.filtros.fechaFin = fechas[1].toISOString().split('T')[0];\n      this.obtenerVentas();\n    },\n    obtenerVentas: function obtenerVentas() {\n      var _this = this;\n\n      this.cargando = true;\n      var payload = {\n        filtros: this.filtros,\n        accion: 'obtener_ventas'\n      };\n      HttpService.obtenerConConsultas('vender.php', payload).then(function (resultado) {\n        _this.ventas = resultado.ventas;\n        _this.totalesGenerales = [{\n          nombre: \"No. Ventas\",\n          total: _this.ventas.length,\n          icono: \"cart\",\n          clase: \"has-text-primary\"\n        }, {\n          nombre: \"Total ventas\",\n          total: '$' + resultado.totalVentas,\n          icono: \"cash-fast\",\n          clase: \"has-text-success\"\n        }, {\n          nombre: \"Ganancia\",\n          total: '$' + Utiles.calcularTotalGanancia(_this.ventas),\n          icono: \"currency-usd\",\n          clase: \"has-text-info\"\n        }, {\n          nombre: \"Productos vendidos\",\n          total: Utiles.calcularProductosVendidos(_this.ventas),\n          icono: \"package-variant\",\n          clase: \"has-text-danger\"\n        }];\n        _this.cargando = false;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4EA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;EACAA,qBADA;EAEAC;IAAAC;IAAAC;IAAAC;IAAAC;IAAAC;EAAA,CAFA;EAIAC;IAAA;MACAC;QACAC,eADA;QAEAC;MAFA,CADA;MAKAC,eALA;MAMAC,UANA;MAOAC,iBAPA;MAQAC,yBARA;MASAC,yBATA;MAUAC,4BAVA;MAWAC,2BAXA;MAYAC,oBAZA;MAaAC,yBAbA;MAcAC,cAdA;MAeAC,UAfA;MAgBAC,oBAhBA;MAiBAC,yBAjBA;MAkBAC;IAlBA;EAAA,CAJA;EAyBAC,OAzBA,qBAyBA;IACA;EACA,CA3BA;EA6BAC;IACAC,SADA,qBACAC,SADA,EACA;MACA;IACA,CAHA;IAKAC,kBALA,8BAKAC,KALA,EAKA;MACA;MACA;IACA,CARA;IAUAC,iBAVA,6BAUAC,MAVA,EAUA;MACA;MACA;MACA;IACA,CAdA;IAgBAC,aAhBA,2BAgBA;MAAA;;MACA;MACA;QACAzB,qBADA;QAEA0B;MAFA;MAIAC,uDACAC,IADA,CACA;QACA;QAEA,0BACA;UAAAC;UAAAC;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAH;UAAAC;UAAAC;UAAAC;QAAA,CAFA,EAGA;UAAAH;UAAAC;UAAAC;UAAAC;QAAA,CAHA,EAIA;UAAAH;UAAAC;UAAAC;UAAAC;QAAA,CAJA;QAMA;MACA,CAXA;IAYA;EAlCA;AA7BA","names":["name","components","BusquedaEnFecha","TablaProductosVendidos","MensajeInicial","CartasTotales","ComprobanteCompra","data","filtros","fechaInicio","fechaFin","cargando","ventas","isPaginated","isPaginationSimple","isPaginationRounded","paginationPosition","defaultSortDirection","sortIcon","sortIconSize","currentPage","perPage","totalesGenerales","mostrarComprobante","ventaSeleccionada","mounted","methods","onImpreso","resultado","generarComprobante","venta","onBusquedaEnFecha","fechas","obtenerVentas","accion","HttpService","then","nombre","total","icono","clase"],"sourceRoot":"src/components/Ventas","sources":["ReporteVentas.vue"],"sourcesContent":["<template>\r\n    <section>\r\n        <p class=\"title is-1\">Reporte de ventas</p> \r\n         <b-breadcrumb\r\n            align=\"is-left\"\r\n        >\r\n            <b-breadcrumb-item tag='router-link' to=\"/\">Inicio</b-breadcrumb-item>\r\n            <b-breadcrumb-item active>Ventas</b-breadcrumb-item>\r\n        </b-breadcrumb>\r\n        <busqueda-en-fecha @seleccionada=\"onBusquedaEnFecha\"/>\r\n        <mensaje-inicial class=\"mt-2\" :titulo=\"'No se han encontrado ventas :('\" :subtitulo=\"'Aquí aparecerán las ventas registradas'\" v-if=\"ventas.length<1\"/>\r\n        <div class=\"mt-2\" v-if=\"ventas.length>0\">\r\n            <cartas-totales :totales=\"totalesGenerales\" />\r\n            <b-select v-model=\"perPage\">\r\n                <option value=\"5\">5 por página</option>\r\n                <option value=\"10\">10 por página</option>\r\n                <option value=\"15\">15 por página</option>\r\n                <option value=\"20\">20 por página</option>\r\n            </b-select>\r\n\r\n            <b-table\r\n            class=\"box\"\r\n            :data=\"ventas\"\r\n            :paginated=\"isPaginated\"\r\n            :per-page=\"perPage\"\r\n            :current-page.sync=\"currentPage\"\r\n            :pagination-simple=\"isPaginationSimple\"\r\n            :pagination-position=\"paginationPosition\"\r\n            :default-sort-direction=\"defaultSortDirection\"\r\n            :pagination-rounded=\"isPaginationRounded\"\r\n            :sort-icon=\"sortIcon\"\r\n            :sort-icon-size=\"sortIconSize\"\r\n            default-sort=\"user.first_name\"\r\n            aria-next-label=\"Next page\"\r\n            aria-previous-label=\"Previous page\"\r\n            aria-page-label=\"Page\"\r\n            aria-current-label=\"Current page\"\r\n            >\r\n              <b-table-column field=\"fecha\" label=\"Fecha\" sortable searchable v-slot=\"props\">\r\n                    {{ props.row.fecha }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"nombreCliente\" label=\"Cliente\" sortable searchable v-slot=\"props\">\r\n                    {{ props.row.nombreCliente }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"nombreUsuario\" label=\"Usuario\" sortable searchable v-slot=\"props\">\r\n                    {{ props.row.nombreUsuario }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"pagado\" label=\"Pago\" sortable v-slot=\"props\">\r\n                    ${{ props.row.pagado }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"Cambio\" label=\"Cambio\" sortable v-slot=\"props\">\r\n                    ${{ props.row.pagado - props.row.total }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"total\" label=\"Total\" sortable  v-slot=\"props\">\r\n                    <b>${{ props.row.total }}</b>\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"productos\" label=\"Productos\" sortable  v-slot=\"props\">\r\n                    <tabla-productos-vendidos :productos=\"props.row.productos\" />\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"ticket\" label=\"Comprobante\" v-slot=\"props\">\r\n                    <b-button type=\"is-info\" icon-left=\"ticket-outline\" @click=\"generarComprobante(props.row)\">Comprobante</b-button>\r\n                </b-table-column>\r\n            </b-table>\r\n        </div>\r\n        <comprobante-compra :venta=\"this.ventaSeleccionada\" :tipo=\"'venta'\" v-if=\"mostrarComprobante\" @impreso=\"onImpreso\"/>\r\n        <b-loading :is-full-page=\"true\" v-model=\"cargando\" :can-cancel=\"false\"></b-loading>\r\n    </section>\r\n</template>\r\n<script>\r\n    import BusquedaEnFecha from '../Extras/BusquedaEnFecha'\r\n    import MensajeInicial from '../Extras/MensajeInicial'\r\n    import CartasTotales from '../Extras/CartasTotales'\r\n    import TablaProductosVendidos from './TablaProductosVendidos'\r\n    import ComprobanteCompra from './ComprobanteCompra'\r\n    import HttpService from '../../Servicios/HttpService'\r\n    import Utiles from '../../Servicios/Utiles'\r\n\r\n    export default {\r\n        name: \"ReporteVentas\",\r\n        components: { BusquedaEnFecha, TablaProductosVendidos, MensajeInicial, CartasTotales, ComprobanteCompra },\r\n\r\n        data:()=>({\r\n            filtros: {\r\n                fechaInicio: \"\",\r\n                fechaFin: \"\"\r\n            },\r\n            cargando: false,\r\n            ventas: [],\r\n            isPaginated: true,\r\n            isPaginationSimple: false,\r\n            isPaginationRounded: true,\r\n            paginationPosition: 'bottom',\r\n            defaultSortDirection: 'asc',\r\n            sortIcon: 'arrow-up',\r\n            sortIconSize: 'is-medium',\r\n            currentPage: 1,\r\n            perPage: 5,\r\n            totalesGenerales: [],\r\n            mostrarComprobante: false,\r\n            ventaSeleccionada: null\r\n        }),\r\n\r\n        mounted(){\r\n            this.obtenerVentas()\r\n        },\r\n\r\n        methods: {\r\n            onImpreso(resultado){\r\n                this.mostrarComprobante = resultado\r\n            },\r\n\r\n            generarComprobante(venta){\r\n                this.mostrarComprobante = true\r\n                this.ventaSeleccionada = venta\r\n            },\r\n\r\n            onBusquedaEnFecha(fechas){\r\n                this.filtros.fechaInicio = fechas[0].toISOString().split('T')[0]\r\n                this.filtros.fechaFin = fechas[1].toISOString().split('T')[0]\r\n                this.obtenerVentas()\r\n            },\r\n\r\n            obtenerVentas(){\r\n                this.cargando = true\r\n                let payload = {\r\n                    filtros: this.filtros,\r\n                    accion: 'obtener_ventas'\r\n                }\r\n                HttpService.obtenerConConsultas('vender.php', payload)\r\n                .then(resultado => {\r\n                    this.ventas = resultado.ventas\r\n\r\n                    this.totalesGenerales = [\r\n                        {nombre: \"No. Ventas\", total: this.ventas.length, icono: \"cart\", clase: \"has-text-primary\"},\r\n                        {nombre: \"Total ventas\", total: '$' + resultado.totalVentas, icono: \"cash-fast\", clase: \"has-text-success\"},\r\n                        {nombre: \"Ganancia\", total: '$' + Utiles.calcularTotalGanancia(this.ventas), icono: \"currency-usd\", clase: \"has-text-info\"},\r\n                        {nombre: \"Productos vendidos\", total: Utiles.calcularProductosVendidos(this.ventas), icono: \"package-variant\", clase: \"has-text-danger\"},\r\n                    ]\r\n                    this.cargando = false\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>"]},"metadata":{},"sourceType":"module"}