{"ast":null,"code":"import \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport BusquedaEnFecha from '../Extras/BusquedaEnFecha';\nimport MensajeInicial from '../Extras/MensajeInicial';\nimport CartasTotales from '../Extras/CartasTotales';\nimport TablaProductosVendidos from './TablaProductosVendidos';\nimport ComprobanteCompra from './ComprobanteCompra';\nimport HttpService from '../../Servicios/HttpService';\nexport default {\n  name: \"ReporteCotizaciones\",\n  components: {\n    BusquedaEnFecha: BusquedaEnFecha,\n    MensajeInicial: MensajeInicial,\n    CartasTotales: CartasTotales,\n    TablaProductosVendidos: TablaProductosVendidos,\n    ComprobanteCompra: ComprobanteCompra\n  },\n  data: function data() {\n    return {\n      filtros: {\n        fechaInicio: \"\",\n        fechaFin: \"\"\n      },\n      cargando: false,\n      cotizaciones: [],\n      totalesGenerales: [],\n      isPaginated: true,\n      isPaginationSimple: false,\n      isPaginationRounded: true,\n      paginationPosition: 'bottom',\n      defaultSortDirection: 'asc',\n      sortIcon: 'arrow-up',\n      sortIconSize: 'is-medium',\n      currentPage: 1,\n      perPage: 5,\n      cotizacionSeleccionada: null,\n      mostrarComprobante: false\n    };\n  },\n  mounted: function mounted() {\n    this.obtenerCotizaciones();\n  },\n  methods: {\n    onImpreso: function onImpreso(resultado) {\n      this.mostrarComprobante = resultado;\n    },\n    generarComprobante: function generarComprobante(cotizacion) {\n      this.cotizacionSeleccionada = cotizacion;\n      this.mostrarComprobante = true;\n    },\n    eliminar: function eliminar(id) {\n      var _this = this;\n\n      this.$buefy.dialog.confirm({\n        title: 'Eliminar cotización',\n        message: '¿Seguro que deseas eliminar esta cotizacion?',\n        confirmText: 'Sí, eliminar',\n        cancelText: 'Cancelar',\n        type: 'is-danger',\n        hasIcon: true,\n        onConfirm: function onConfirm() {\n          _this.cargando = true;\n          HttpService.eliminar('vender.php', {\n            accion: 'eliminar_cotizacion',\n            id: id\n          }).then(function (resultado) {\n            if (resultado) {\n              _this.cargando = false;\n\n              _this.$buefy.toast.open('cotización eliminada');\n\n              _this.obtenerCotizaciones();\n            }\n          });\n        }\n      });\n    },\n    onBusquedaEnFecha: function onBusquedaEnFecha(fechas) {\n      this.filtros.fechaInicio = fechas[0].toISOString().split('T')[0];\n      this.filtros.fechaFin = fechas[1].toISOString().split('T')[0];\n      this.obtenerCotizaciones();\n    },\n    obtenerCotizaciones: function obtenerCotizaciones() {\n      var _this2 = this;\n\n      this.cargando = true;\n      var payload = {\n        filtros: this.filtros,\n        accion: 'obtener_cotizaciones'\n      };\n      HttpService.obtenerConConsultas('vender.php', payload).then(function (resultado) {\n        _this2.cotizaciones = resultado.cotizaciones;\n        _this2.totalesGenerales = [{\n          nombre: \"Cotizaciones registradas\",\n          total: _this2.cotizaciones.length,\n          icono: \"ticket-outline\",\n          clase: \"has-text-primary\"\n        }];\n        _this2.cargando = false;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AAEA;EACAA,2BADA;EAEAC;IAAAC;IAAAC;IAAAC;IAAAC;IAAAC;EAAA,CAFA;EAIAC;IAAA;MACAC;QACAC,eADA;QAEAC;MAFA,CADA;MAKAC,eALA;MAMAC,gBANA;MAOAC,oBAPA;MAQAC,iBARA;MASAC,yBATA;MAUAC,yBAVA;MAWAC,4BAXA;MAYAC,2BAZA;MAaAC,oBAbA;MAcAC,yBAdA;MAeAC,cAfA;MAgBAC,UAhBA;MAiBAC,4BAjBA;MAkBAC;IAlBA;EAAA,CAJA;EAyBAC,OAzBA,qBAyBA;IACA;EACA,CA3BA;EA6BAC;IACAC,SADA,qBACAC,SADA,EACA;MACA;IACA,CAHA;IAKAC,kBALA,8BAKAC,UALA,EAKA;MACA;MACA;IACA,CARA;IAUAC,QAVA,oBAUAC,EAVA,EAUA;MAAA;;MACA;QACAC,4BADA;QAEAC,uDAFA;QAGAC,2BAHA;QAIAC,sBAJA;QAKAC,iBALA;QAMAC,aANA;QAOAC;UACA;UACAC;YACAC,6BADA;YAEAT;UAFA,GAIAU,IAJA,CAIA;YACA;cACA;;cACA;;cACA;YACA;UACA,CAVA;QAYA;MArBA;IAuBA,CAlCA;IAoCAC,iBApCA,6BAoCAC,MApCA,EAoCA;MACA;MACA;MACA;IACA,CAxCA;IA0CAC,mBA1CA,iCA0CA;MAAA;;MACA;MACA;QACArC,qBADA;QAEAiC;MAFA;MAIAD,uDACAE,IADA,CACA;QACA;QAEA,2BACA;UAAAI;UAAAC;UAAAC;UAAAC;QAAA,CADA;QAGA;MACA,CARA;IASA;EAzDA;AA7BA","names":["name","components","BusquedaEnFecha","MensajeInicial","CartasTotales","TablaProductosVendidos","ComprobanteCompra","data","filtros","fechaInicio","fechaFin","cargando","cotizaciones","totalesGenerales","isPaginated","isPaginationSimple","isPaginationRounded","paginationPosition","defaultSortDirection","sortIcon","sortIconSize","currentPage","perPage","cotizacionSeleccionada","mostrarComprobante","mounted","methods","onImpreso","resultado","generarComprobante","cotizacion","eliminar","id","title","message","confirmText","cancelText","type","hasIcon","onConfirm","HttpService","accion","then","onBusquedaEnFecha","fechas","obtenerCotizaciones","nombre","total","icono","clase"],"sourceRoot":"src/components/Ventas","sources":["ReporteCotizaciones.vue"],"sourcesContent":["<template>\r\n    <section>\r\n        <p class=\"title is-1\">Reporte de cotizaciones</p>\r\n         <b-breadcrumb\r\n            align=\"is-left\"\r\n        >\r\n            <b-breadcrumb-item tag='router-link' to=\"/\">Inicio</b-breadcrumb-item>\r\n            <b-breadcrumb-item active>Cotizaciones</b-breadcrumb-item> \r\n        </b-breadcrumb>\r\n        <busqueda-en-fecha @seleccionada=\"onBusquedaEnFecha\"/>\r\n        <mensaje-inicial class=\"mt-2\" :titulo=\"'No se han encontrado cotizaciones :('\" :subtitulo=\"'Aquí aparecerán las cotizaciones registradas'\" v-if=\"cotizaciones.length<1\"/>\r\n        <div class=\"mt-2\" v-if=\"cotizaciones.length>0\">\r\n            <cartas-totales :totales=\"totalesGenerales\" />\r\n            <b-select v-model=\"perPage\">\r\n                <option value=\"5\">5 por página</option>\r\n                <option value=\"10\">10 por página</option>\r\n                <option value=\"15\">15 por página</option>\r\n                <option value=\"20\">20 por página</option>\r\n            </b-select>\r\n\r\n            <b-table\r\n                class=\"box\"\r\n                :data=\"cotizaciones\"\r\n                :paginated=\"isPaginated\"\r\n                :per-page=\"perPage\"\r\n                :current-page.sync=\"currentPage\"\r\n                :pagination-simple=\"isPaginationSimple\"\r\n                :pagination-position=\"paginationPosition\"\r\n                :default-sort-direction=\"defaultSortDirection\"\r\n                :pagination-rounded=\"isPaginationRounded\"\r\n                :sort-icon=\"sortIcon\"\r\n                :sort-icon-size=\"sortIconSize\"\r\n                default-sort=\"user.first_name\"\r\n                aria-next-label=\"Next page\"\r\n                aria-previous-label=\"Previous page\"\r\n                aria-page-label=\"Page\"\r\n                aria-current-label=\"Current page\"\r\n                >\r\n                <b-table-column field=\"fecha\" label=\"Fecha\" sortable searchable v-slot=\"props\">\r\n                    {{ props.row.fecha }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"nombreCliente\" label=\"Cliente\" sortable searchable v-slot=\"props\">\r\n                    {{ props.row.nombreCliente }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"nombreUsuario\" label=\"Usuario\" sortable searchable v-slot=\"props\">\r\n                    {{ props.row.nombreUsuario }}\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"total\" label=\"Total\" sortable  v-slot=\"props\">\r\n                    <b>${{ props.row.total }}</b>\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"productos\" label=\"Productos\" sortable  v-slot=\"props\">\r\n                    <tabla-productos-vendidos :productos=\"props.row.productos\" />\r\n                </b-table-column>\r\n\r\n                <b-table-column field=\"ticket\" label=\"Comprobante\" v-slot=\"props\">\r\n                    <b-button type=\"is-info\" @click=\"generarComprobante(props.row)\">\r\n                        <b-icon\r\n                        icon=\"ticket-outline\">\r\n                        </b-icon>   \r\n                    </b-button>\r\n                </b-table-column> \r\n\r\n                <b-table-column field=\"eliminar\" label=\"Eliminar\" v-slot=\"props\">\r\n                    <b-button type=\"is-danger\" @click=\"eliminar(props.row.id)\">\r\n                        <b-icon\r\n                        icon=\"delete\">\r\n                        </b-icon>   \r\n                    </b-button>\r\n                </b-table-column> \r\n            </b-table>\r\n        </div>\r\n        <comprobante-compra :venta=\"this.cotizacionSeleccionada\" :tipo=\"'cotiza'\" @impreso=\"onImpreso\" v-if=\"mostrarComprobante\" />\r\n        <b-loading :is-full-page=\"true\" v-model=\"cargando\" :can-cancel=\"false\"></b-loading>\r\n    </section>\r\n</template>\r\n<script>\r\n    import BusquedaEnFecha from '../Extras/BusquedaEnFecha'\r\n    import MensajeInicial from '../Extras/MensajeInicial'\r\n    import CartasTotales from '../Extras/CartasTotales'\r\n    import TablaProductosVendidos from './TablaProductosVendidos'\r\n    import ComprobanteCompra from './ComprobanteCompra'\r\n    import HttpService from '../../Servicios/HttpService'\r\n\r\n    export default {\r\n        name: \"ReporteCotizaciones\",\r\n        components: { BusquedaEnFecha, MensajeInicial, CartasTotales, TablaProductosVendidos, ComprobanteCompra },\r\n\r\n        data:()=>({\r\n            filtros: {\r\n                fechaInicio: \"\",\r\n                fechaFin: \"\"\r\n            },\r\n            cargando: false,\r\n            cotizaciones: [],\r\n            totalesGenerales: [],\r\n            isPaginated: true,\r\n            isPaginationSimple: false,\r\n            isPaginationRounded: true,\r\n            paginationPosition: 'bottom',\r\n            defaultSortDirection: 'asc',\r\n            sortIcon: 'arrow-up',\r\n            sortIconSize: 'is-medium',\r\n            currentPage: 1,\r\n            perPage: 5,\r\n            cotizacionSeleccionada: null,\r\n            mostrarComprobante: false\r\n        }),\r\n\r\n        mounted(){\r\n            this.obtenerCotizaciones()\r\n        },\r\n\r\n        methods: {\r\n            onImpreso(resultado){\r\n                this.mostrarComprobante = resultado\r\n            }, \r\n            \r\n            generarComprobante(cotizacion){\r\n                this.cotizacionSeleccionada = cotizacion\r\n                this.mostrarComprobante = true\r\n            },\r\n\r\n            eliminar(id){\r\n                this.$buefy.dialog.confirm({\r\n                    title: 'Eliminar cotización',\r\n                    message: '¿Seguro que deseas eliminar esta cotizacion?',\r\n                    confirmText: 'Sí, eliminar',\r\n                    cancelText: 'Cancelar',\r\n                    type: 'is-danger',\r\n                    hasIcon: true,\r\n                    onConfirm: () => {\r\n                        this.cargando = true\r\n                        HttpService.eliminar('vender.php',{\r\n                            accion: 'eliminar_cotizacion',\r\n                            id:id\r\n                        })\r\n                        .then(resultado =>{\r\n                            if(resultado){\r\n                                this.cargando = false\r\n                                this.$buefy.toast.open('cotización eliminada')\r\n                                this.obtenerCotizaciones()\r\n                            }\r\n                        })\r\n                        \r\n                    }\r\n                })\r\n            },\r\n\r\n            onBusquedaEnFecha(fechas){\r\n                this.filtros.fechaInicio = fechas[0].toISOString().split('T')[0]\r\n                this.filtros.fechaFin = fechas[1].toISOString().split('T')[0]\r\n                this.obtenerCotizaciones()\r\n            },\r\n\r\n            obtenerCotizaciones(){\r\n                this.cargando = true\r\n                let payload = {\r\n                    filtros: this.filtros,\r\n                    accion: 'obtener_cotizaciones'\r\n                }\r\n                HttpService.obtenerConConsultas('vender.php', payload)\r\n                .then(resultado => {\r\n                    this.cotizaciones = resultado.cotizaciones\r\n\r\n                    this.totalesGenerales = [\r\n                        {nombre: \"Cotizaciones registradas\", total: this.cotizaciones.length, icono: \"ticket-outline\", clase: \"has-text-primary\"},\r\n                    ]\r\n                    this.cargando = false\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>"]},"metadata":{},"sourceType":"module"}